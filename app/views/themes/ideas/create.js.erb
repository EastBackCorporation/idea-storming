<% if @idea.errors.any? %>
  <% # バリデーションに失敗した場合 %>
  $('.idea-form').html('<%= j(render "themes/ideas/form", idea: @idea, parent_idea_id: @idea&.parent&.id, theme: @theme) %>');
<% else %>
  <% #  %>
  <% if @idea.parent.present? %>
    $('.idea_<%= @idea.parent&.id %>').html('<%= j(render "themes/ideas/plus_minus", idea: @idea.parent, theme: @theme, minus: true) %>');
    $('.idea_<%= @idea.parent&.id %>_sub').prepend('<%= j(render "themes/ideas/idea", theme: @theme.reload, idea: @idea) %>');
  <% else %>
    $('.themes-ideas-idea-tree').prepend('<%= j(render "themes/ideas/idea", theme: @theme.reload, idea: @idea) %>');
  <% end %>

  <% #フォームを隠す %>
  $('.idea-form').slideToggle(100);

  $(".idea-add-new").off('click');
  $(".idea-add-new").on('click', function(){
    $('.idea-form').slideToggle(100);
  });

  $(".idea-add-close").off('click');
  $(".idea-add-close").on('click', function(){ $('.idea-form').slideToggle(100); });
<% end %>
